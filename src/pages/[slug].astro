---
import Layout from "@layouts/Layout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const pages = await getCollection("pages");

  return pages
    .filter((page) => !page.data.isHomePage)
    .map((page) => {
      const slug = page.data.slug || `/${page.id.replace(/\.mdx$/, "")}`;

      return {
        params: {
          slug: slug.replace(/^\//, ""),
        },
        props: { page },
      };
    });
}

const { page } = Astro.props;
const { Content } = await page.render();
---

<Layout title={page.data.title} description={page.data.description}>
  <div class="mx-auto max-w-4xl">
    <div class="mb-8 rounded-lg bg-white p-8 shadow-sm">
      <h1 class="mb-6 font-heading text-4xl font-bold">{page.data.title}</h1>

      <div class="prose max-w-none lg:prose-xl">
        <Content />
      </div>
    </div>
  </div>
</Layout>
