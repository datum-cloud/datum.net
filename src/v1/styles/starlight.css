@layer base, starlight, theme, components, utilities;

@import './fonts.css';
@import 'tailwindcss';

@plugin '@tailwindcss/typography';
@plugin '@tailwindcss/aspect-ratio';

@import './variables.css';

@import './theme.css';

@import './variables-breakpoints.css';

@layer base {
  html {
    @apply scroll-smooth;
  }

  body {
    @apply antialiased;
    @apply font-primary;
  }

  *,
  ::after,
  ::before {
    border: 0 solid;
  }
  /* Keep base font-family styles even in non-Starlight pages. */
  html,
  :host {
    font-family: var(--font-sans);
  }
  code,
  kbd,
  samp,
  pre {
    font-family: var(--font-mono);
  }

  body {
    &.mobile-menu-open {
      @apply fixed w-full touch-none overflow-hidden;
    }
  }

  [x-cloak] {
    @apply hidden;
  }
  .sl-markdown-content {
    ul:not([role='tablist']),
    ol:not([role='tablist']) {
      @apply mb-4! space-y-2.5! pl-6! leading-[1.5];
    }

    ul:not([role='tablist']) {
      @apply list-disc;
    }

    ol:not([role='tablist']) {
      @apply list-decimal;
    }

    li:not(.tab) {
      @apply [&>p:only-child]:mb-0!;
    }
  }
}

@layer utilities {
  /* Wire up Starlight theme to use Tailwind config. */
  :root {
    --sl-content-gap-y: var(--docs-article-body-paragraph-spacing);
    --__sl-font: var(--font-primary);
    --sl-z-index-menu: 70;

    --color-note: #fffbc5;
    --color-caution: #fde2e2;
    --color-tip: #e2e9e3;

    --sl-line-height-headings: 141%;
    --sl-color-text: var(--color-glacier-mist-700);
    --sl-color-text-accent: var(--color-aurora-moss);
    --sl-line-height: 1.5;
    --sl-text-h1: 30px;
    --sl-text-h2: 20px;
    --sl-text-h3: 18px;

    --sl-menu-button-size: 30px;

    --sl-color-bg: var(--color-midnight-fjord);
    --sl-color-bg-sidebar: var(--color-midnight-fjord);
    /* Use Tailwind-configured font families. */
    --sl-font: var(--font-sans);
    --sl-font-mono: var(--font-mono);
    /* Dark mode Starlight theme variables. */
    --sl-color-dialog: #1e2939;
    --sl-color-dialog-border: #384555;

    --sl-color-search: var(--color-aurora-moss);
    --sl-color-text-search: color-mix(in srgb, var(--color-glacier-mist-700) 60%, transparent);
    --sl-color-kbd: color-mix(in srgb, var(--color-glacier-mist-800) 10%, transparent);

    --sl-color-white: var(--color-white);
    --sl-color-gray-1: var(--color-gray-200);
    --sl-color-gray-2: var(--color-gray-300);
    --sl-color-gray-3: var(--color-gray-400);
    --sl-color-gray-4: var(--color-gray-600);
    --sl-color-gray-5: color-mix(in srgb, var(--color-glacier-mist-900) 20%, transparent);
    --sl-color-gray-6: var(--color-gray-800);
    --sl-color-black: var(--color-midnight-fjord);
    --sl-color-accent-low: var(--color-accent-950, var(--color-accent-900, #1e1b4b));
    --sl-color-accent: var(--color-accent-600, #4f46e5);
    --sl-color-accent-high: var(--color-accent-200, #c7d2fe);
    --color-borderpanel: color-mix(in srgb, var(--color-glacier-mist-900) 10%, transparent);

    &[data-theme='dark'] {
      --ec-code-background: color-mix(in srgb, var(--color-glacier-mist-700) 7%, transparent);
      --ec-code-header-background: color-mix(
        in srgb,
        var(--color-glacier-mist-800) 3%,
        transparent
      );
    }
    /* Light mode Starlight theme variables. */
    &[data-theme='light'] {
      --sl-color-dialog: var(--color-glacier-mist-800);
      --sl-color-dialog-border: var(--color-glacier-mist-900);

      --sl-color-search: var(--color-canyon-clay);
      --sl-color-text-search: color-mix(in srgb, var(--color-midnight-fjord) 60%, transparent);
      --sl-color-kbd: var(--color-glacier-mist-800);

      --sl-color-text: var(--color-midnight-fjord);
      --sl-color-text-accent: var(--color-canyon-clay);
      --sl-color-bg: var(--color-glacier-mist-700);
      --sl-color-bg-sidebar: var(--color-glacier-mist-700);

      --sl-color-white: var(--color-gray-900);
      --sl-color-gray-1: var(--color-gray-800);
      --sl-color-gray-2: var(--color-gray-700);
      --sl-color-gray-3: var(--color-gray-500);
      --sl-color-gray-4: var(--color-gray-400);
      --sl-color-gray-5: var(--color-glacier-mist-900);
      --sl-color-gray-6: var(--color-gray-200);
      --sl-color-gray-7: var(--color-gray-100);
      --sl-color-black: var(--color-white);
      --sl-color-accent-low: var(--color-accent-200, #c7d2fe);
      --sl-color-accent: var(--color-accent-600, #4f46e5);
      --sl-color-accent-high: var(--color-accent-900, #312e81);
      --color-borderpanel: var(--color-glacier-mist-900);

      --ec-code-background: var(--color-white);
      --ec-code-header-background: color-mix(
        in srgb,
        var(--color-glacier-mist-800) 40%,
        transparent
      );
    }
  }
}

@import './utilities.css';

@import './components.css';

@import './components-hero.css';

@import './components-nav.css';

@import './components-buttons.css';

@import './components-dark.css';

@layer starlight.components {
  .expressive-code .frame pre {
    background: var(--ec-code-background) !important;
  }

  .expressive-code .frame.is-terminal .header {
    background: var(--ec-code-header-background) !important;
  }

  &[data-theme='dark'] {
    .sl-markdown-content {
      .starlight-aside {
        @apply text-midnight-fjord;
      }
    }

    .footer {
      @apply border-t-1 border-[color:var(--color-borderpanel)];
    }
  }

  .sl-markdown-content {
    @apply datum-prose-docs-article;
    /* @apply prose max-w-none; */
    @apply text-[color:var(--sl-color-text)];

    strong,
    b {
      @apply text-[color:var(--sl-color-text)];
    }

    .starlight-aside {
      @apply px-8 py-6;
      @apply mb-[var(--sl-content-gap-y)]!;

      a {
        @apply text-[color:var(--color-canyon-clay---links)]!;
        @apply hover:text-[color:var(--color-canyon-clay---links)]/80!;
      }
    }

    .starlight-aside--note {
      --sl-color-asides-border: color-mix(in srgb, var(--color-midnight-fjord) 10%, transparent);
      @apply bg-[var(--color-note)];
    }

    .starlight-aside--caution {
      --sl-color-asides-border: color-mix(in srgb, var(--color-midnight-fjord) 10%, transparent);
      @apply bg-[var(--color-caution)];
    }

    .starlight-aside--tip {
      --sl-color-asides-border: color-mix(in srgb, var(--color-midnight-fjord) 10%, transparent);
      @apply bg-[var(--color-tip)];
    }

    .starlight-aside__title {
      @apply text-midnight-fjord text-lg font-semibold;
    }

    h1,
    h2,
    h3 {
      @apply font-bold;
    }

    h1 {
      @apply datum-text-2xl;
    }

    h2 {
      @apply datum-text-xl;
    }

    h3 {
      @apply datum-text-lg;
    }
  }
}

@layer starlight.reset {
  body {
    @apply font-primary;
    @apply leading-1.5;
  }

  /* Override all Starlight text elements */
  p,
  li,
  a,
  button,
  input,
  textarea,
  select,
  label {
    @apply font-primary;
  }

  a:any-link {
    @apply no-underline;
  }

  /* Override Starlight component fonts */
  .sl-stack,
  .sl-content,
  .sl-sidebar,
  .sl-nav,
  .sl-breadcrumb,
  .sl-toc,
  .sl-search,
  .sl-theme-toggle,
  .sl-language-select,
  .sl-social-links {
    @apply font-primary;
  }

  /* Additional Starlight-specific selectors */
  [data-astro-cid],
  .sl-content-panel,
  .sl-content-wrapper,
  .sl-page,
  .sl-page-header,
  .sl-page-content,
  .sl-page-footer {
    @apply font-primary;
  }
}

@layer starlight.core {
  /* Lock body scroll when dialogs or mobile sidebar are open */
  [data-search-modal-open] {
    overflow: hidden;
  }

  .sl-mobile-menu-toggle {
    @apply hidden;
    @apply [&_svg]:bg-[var(--sl-color-bg)];
    @apply fixed top-0 left-0;
    /* @apply absolute top-[40px] right-0 z-[var(--sl-z-index-navbar)] cursor-pointer border-0 p-0 text-[var(--color-text)]; */
  }

  [data-mobile-menu-expanded] {
    .sidebar {
      @apply block h-dvh w-full pb-50;
      @apply absolute top-33 left-0;
      @apply z-[var(--sl-z-index-menu)];
      @apply overflow-y-auto;
    }
    .sidebar-pane {
      @apply px-0 pt-3;
    }
  }
  /* search button */

  site-search-button {
    display: contents;
  }

  button[data-open-modal] {
    @apply flex w-full cursor-pointer items-center gap-2 border-0;
    @apply rounded-lg border border-[color:var(--sl-color-gray-5)];
    @apply py-2 pr-2 pl-3;
    @apply bg-[var(--sl-color-black)] text-sm text-[var(--sl-color-text-search)];
    svg {
      @apply text-[var(--sl-color-search)];
    }
  }

  button[data-open-modal]:hover {
    border-color: var(--sl-color-gray-2);
    color: var(--sl-color-white);
  }

  button[data-open-modal] > :last-child {
    margin-inline-start: auto;
  }

  button > kbd {
    @apply gap-1 rounded bg-[var(--sl-color-kbd)] p-[0.375rem] text-[12px] leading-[1];
  }

  kbd {
    font-family: var(--__sl-font);
  }

  /* PageFrame.astro */
  .sidebar {
    @apply block w-full flex-none md:w-[215px] lg:w-[259px];
    @apply hidden bg-[var(--sl-color-bg)] md:block;
  }

  .sidebar-pane {
    @apply border-r-0 md:border-r md:border-[color:var(--color-borderpanel)];
    @apply pt-6 pr-6 pb-10 pl-6 md:pt-7 md:pb-0 md:pl-0;
    @apply relative w-full md:h-full;
  }

  .searchbar-main-content {
    @apply -ml-6 block border-b border-[color:var(--color-borderpanel)] px-6 py-2.5 md:hidden print:hidden;
    @apply w-[calc(100%+theme(spacing.12))];
  }

  .sidebar-content {
    @apply flex h-full min-h-max flex-col gap-6 overflow-y-auto pb-10;

    ul.top-level {
      @apply [&>li:first-child]:mb-4;

      > li + li {
        @apply mt-0 mb-4;
      }
      li {
        @apply leading-[18px];
        summary {
          @apply p-0 hover:text-(--sl-color-text-accent);
          .large {
            @apply datum-docs-sidebar-headings text-(--sl-color-text);
          }
        }

        ul {
          @apply mt-[6px];
        }

        > a.large {
          @apply datum-docs-sidebar-headings p-0 text-(--sl-color-text) hover:text-(--sl-color-text-accent);
        }
        > a.large[aria-current='page'] {
          @apply bg-transparent font-bold text-(--sl-color-text-accent);
        }

        li {
          @apply ml-0 border-l-0 pl-0;
          @apply mb-[5px];

          a {
            @apply datum-docs-sidebar-links p-0 pr-5 text-(--sl-color-text)/80 hover:text-(--sl-color-text-accent);
          }

          a[aria-current='page'] {
            @apply bg-transparent font-semibold text-(--sl-color-text-accent);
          }
        }
      }
    }
  }

  .main-frame {
    @apply relative mx-auto flex w-full max-w-391;
  }

  /* End of PageFrame.astro */

  /* Header.astro */
  header.sl-header {
    @apply border-b border-[color:var(--color-borderpanel)];
  }

  /* End of Header.astro */

  /* ContentPanel.astro */
  .sl-content {
    @apply px-0 py-5 pb-20 md:pr-0 md:pl-10 lg:px-10;

    .content-panel {
      @apply p-0;
    }
    .content-panel + .content-panel {
      @apply border-t-0;
    }

    @apply [&_.content-panel:first-child_h1]:datum-text-3xl [&_.content-panel:first-child]:pb-6 [&_.content-panel:first-child_h1]:mt-0 [&_.content-panel:first-child_h1]:font-bold;

    .sl-container {
      @apply max-w-none;
    }
  }
  /* End of ContentPanel.astro */

  /* TwoColumnContent.astro */

  .sl-content-panel {
    @apply relative block w-full grow md:w-[calc(100%-215px)] md:pr-0 lg:w-[calc(100%-198px)] lg:pr-[198px] xl:w-[calc(100%-213px)] xl:pr-[213px];
  }

  .sl-main-content {
    /* @apply w-full max-w-[1130px]; */
    @apply max-w-full;

    astro-breadcrumbs {
      nav.c-breadcrumbs {
        @apply mt-6! mb-0! flex! md:mt-9! md:px-10!;
      }
    }
  }

  .sl-content-wrapper {
    @apply flex min-w-0;
  }

  /* End of TwoColumnContent.astro */
  /* PageSidebar.astro */

  .right-sidebar-container {
    @apply w-full overflow-y-clip lg:max-w-[198px] xl:max-w-[213px];
    @apply hidden lg:flex;
    @apply absolute top-0 right-0 h-full;
    z-index: var(--sl-z-index-toc);

    .right-sidebar {
      @apply pt-7 pl-6;
      @apply border-l border-[color:var(--color-borderpanel)];
    }
  }
  .right-sidebar {
    .right-sidebar-panel {
      @apply sticky top-3 self-start p-0;

      h2 {
        @apply datum-docs-sidebar-headings mb-3 text-(--sl-color-text);
      }

      ul {
        li {
          @apply mb-[5px];
          a {
            @apply datum-docs-sidebar-links p-0 text-(--sl-color-text)/80 hover:text-(--sl-color-text-accent);
          }
        }
        ul {
          @apply mt-[5px];
        }
      }
    }
  }

  /* End of PageSidebar.astro */

  .pagination-links {
    > a {
      @apply rounded-none border-[color:var(--sl-color-text)] px-7 py-6 transition-all duration-200 hover:border-[color:var(--sl-color-text)]/50;
      span {
        @apply datum-docs-sidebar-headings;
        .link-title {
          @apply datum-text-base mt-2 block font-bold capitalize;
        }
      }
    }
  }
}

.sl-markdown-content .expressive-code .frame {
  @apply shadow-none;
}

.pagination-links a {
  @apply shadow-none;
}
